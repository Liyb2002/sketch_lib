{
  "ok": true,
  "in_bbox_json": "/Users/yuanboli/Documents/GitHub/sketch_lib/controlNet_process/sketch/dsl_optimize/optimize_iteration/iter_000/heat_map/pca_bboxes/pca_bboxes.json",
  "out_bbox_json": "/Users/yuanboli/Documents/GitHub/sketch_lib/controlNet_process/sketch/dsl_optimize/optimize_iteration/iter_000/heat_map/pca_bboxes/pca_bboxes_optimized.json",
  "labels": 17,
  "relations_json": "/Users/yuanboli/Documents/GitHub/sketch_lib/controlNet_process/sketch/dsl_optimize/relations.json",
  "same_pairs": [
    {
      "a": "wheel_0",
      "b": "wheel_1",
      "confidence": 1.0,
      "evidence": "both wheels"
    }
  ],
  "heat_gamma": 2.0,
  "weights": {
    "w_overlap": 1.0,
    "w_value": 1.0,
    "w_same": 1.0
  },
  "final": {
    "overlap_L": 0.41864088341166555,
    "value_L": 0.009715462553939564,
    "same_L": 0.2282762236914326,
    "core_loss": 0.6566325696570378,
    "overlap_pairs": 75,
    "inter_sum": 0.2325031547151396
  },
  "history": [
    {
      "iter": 0,
      "step_frac": 0.06,
      "overlap_L": 0.45851390554175425,
      "value_L": 0.0,
      "same_L": 0.25148398047151627,
      "core_loss": 0.7099978860132705,
      "overlap_pairs": 78,
      "inter_sum": 0.29032827710603787,
      "active_k": 10
    },
    {
      "iter": 1,
      "step_frac": 0.06,
      "overlap_L": 0.4616071028673091,
      "value_L": 0.0,
      "same_L": 0.2388194504574459,
      "core_loss": 0.700426553324755,
      "overlap_pairs": 78,
      "inter_sum": 0.28831210227867965,
      "active_k": 10
    },
    {
      "iter": 2,
      "step_frac": 0.06,
      "overlap_L": 0.458112397554386,
      "value_L": 2.356411166708275e-15,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6969318480118343,
      "overlap_pairs": 78,
      "inter_sum": 0.28466682736190896,
      "active_k": 10
    },
    {
      "iter": 3,
      "step_frac": 0.06,
      "overlap_L": 0.45302734240919984,
      "value_L": 0.0025909014776193152,
      "same_L": 0.2388194504574459,
      "core_loss": 0.694437694344265,
      "overlap_pairs": 78,
      "inter_sum": 0.2794076975405038,
      "active_k": 10
    },
    {
      "iter": 4,
      "step_frac": 0.06,
      "overlap_L": 0.4473737342839539,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.691909323609749,
      "overlap_pairs": 78,
      "inter_sum": 0.27467365407207645,
      "active_k": 10
    },
    {
      "iter": 5,
      "step_frac": 0.06,
      "overlap_L": 0.4452092125374785,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6897448018632737,
      "overlap_pairs": 78,
      "inter_sum": 0.27051690040478665,
      "active_k": 10
    },
    {
      "iter": 6,
      "step_frac": 0.06,
      "overlap_L": 0.44331368251759967,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6878492718433948,
      "overlap_pairs": 78,
      "inter_sum": 0.2668608771454747,
      "active_k": 10
    },
    {
      "iter": 7,
      "step_frac": 0.06,
      "overlap_L": 0.4416565663742732,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6861921557000683,
      "overlap_pairs": 78,
      "inter_sum": 0.2636406203640196,
      "active_k": 10
    },
    {
      "iter": 8,
      "step_frac": 0.06,
      "overlap_L": 0.43979526914351136,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6843308584693064,
      "overlap_pairs": 78,
      "inter_sum": 0.2605542778460417,
      "active_k": 10
    },
    {
      "iter": 9,
      "step_frac": 0.06,
      "overlap_L": 0.4382408957279428,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6827764850537379,
      "overlap_pairs": 78,
      "inter_sum": 0.25768967049378916,
      "active_k": 10
    },
    {
      "iter": 10,
      "step_frac": 0.06,
      "overlap_L": 0.4360912064789649,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.68062679580476,
      "overlap_pairs": 78,
      "inter_sum": 0.255483483563451,
      "active_k": 10
    },
    {
      "iter": 11,
      "step_frac": 0.06,
      "overlap_L": 0.43494958246729576,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6794851717930909,
      "overlap_pairs": 76,
      "inter_sum": 0.25294411970779673,
      "active_k": 10
    },
    {
      "iter": 12,
      "step_frac": 0.06,
      "overlap_L": 0.4329751136260208,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6775107029518159,
      "overlap_pairs": 76,
      "inter_sum": 0.25008626588356486,
      "active_k": 10
    },
    {
      "iter": 13,
      "step_frac": 0.06,
      "overlap_L": 0.43190841883604103,
      "value_L": 0.005716138868349199,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6764440081618361,
      "overlap_pairs": 76,
      "inter_sum": 0.2494701433664312,
      "active_k": 10
    },
    {
      "iter": 14,
      "step_frac": 0.06,
      "overlap_L": 0.43133668737030256,
      "value_L": 0.005716138868349346,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6758722766960978,
      "overlap_pairs": 76,
      "inter_sum": 0.2485304178883072,
      "active_k": 10
    },
    {
      "iter": 15,
      "step_frac": 0.06,
      "overlap_L": 0.4311415638257402,
      "value_L": 0.005716138868349346,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6756771531515354,
      "overlap_pairs": 76,
      "inter_sum": 0.24771774298295393,
      "active_k": 10
    },
    {
      "iter": 16,
      "step_frac": 0.06,
      "overlap_L": 0.4309879857688972,
      "value_L": 0.005716138868349273,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6755235750946924,
      "overlap_pairs": 76,
      "inter_sum": 0.2467960362387891,
      "active_k": 10
    },
    {
      "iter": 17,
      "step_frac": 0.06,
      "overlap_L": 0.43091113072157355,
      "value_L": 0.00571613886834942,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6754467200473688,
      "overlap_pairs": 76,
      "inter_sum": 0.24596121804964705,
      "active_k": 10
    },
    {
      "iter": 18,
      "step_frac": 0.06,
      "overlap_L": 0.4309023073791195,
      "value_L": 0.005716138868349346,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6754378967049147,
      "overlap_pairs": 76,
      "inter_sum": 0.2452038959796299,
      "active_k": 10
    },
    {
      "iter": 19,
      "step_frac": 0.06,
      "overlap_L": 0.4309023073791195,
      "value_L": 0.005716138868349346,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6754378967049147,
      "overlap_pairs": 76,
      "inter_sum": 0.2452038959796299,
      "active_k": 10
    },
    {
      "iter": 20,
      "step_frac": 0.06,
      "overlap_L": 0.4309023073791195,
      "value_L": 0.005716138868349346,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6754378967049147,
      "overlap_pairs": 76,
      "inter_sum": 0.2452038959796299,
      "active_k": 10
    },
    {
      "iter": 21,
      "step_frac": 0.06,
      "overlap_L": 0.4309023073791195,
      "value_L": 0.005716138868349346,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6754378967049147,
      "overlap_pairs": 76,
      "inter_sum": 0.2452038959796299,
      "active_k": 10
    },
    {
      "iter": 22,
      "step_frac": 0.06,
      "overlap_L": 0.4309023073791195,
      "value_L": 0.005716138868349346,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6754378967049147,
      "overlap_pairs": 76,
      "inter_sum": 0.2452038959796299,
      "active_k": 10
    },
    {
      "iter": 23,
      "step_frac": 0.06,
      "overlap_L": 0.4309023073791195,
      "value_L": 0.005716138868349346,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6754378967049147,
      "overlap_pairs": 76,
      "inter_sum": 0.2452038959796299,
      "active_k": 10
    },
    {
      "iter": 24,
      "step_frac": 0.03,
      "overlap_L": 0.4309023073791195,
      "value_L": 0.005716138868349346,
      "same_L": 0.2388194504574459,
      "core_loss": 0.6754378967049147,
      "overlap_pairs": 76,
      "inter_sum": 0.2452038959796299,
      "active_k": 10
    },
    {
      "iter": 25,
      "step_frac": 0.03,
      "overlap_L": 0.42797248834236234,
      "value_L": 0.005716138868349346,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6659799694134821,
      "overlap_pairs": 76,
      "inter_sum": 0.24188069301650247,
      "active_k": 10
    },
    {
      "iter": 26,
      "step_frac": 0.03,
      "overlap_L": 0.42606366433503284,
      "value_L": 0.005716138868351703,
      "same_L": 0.23229134220277048,
      "core_loss": 0.664071145406155,
      "overlap_pairs": 76,
      "inter_sum": 0.24080186742299833,
      "active_k": 10
    },
    {
      "iter": 27,
      "step_frac": 0.03,
      "overlap_L": 0.4244010724124441,
      "value_L": 0.005813929274168788,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6625063438893835,
      "overlap_pairs": 76,
      "inter_sum": 0.2388943261904099,
      "active_k": 10
    },
    {
      "iter": 28,
      "step_frac": 0.03,
      "overlap_L": 0.4238305825067583,
      "value_L": 0.005813929274168788,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6619358539836976,
      "overlap_pairs": 76,
      "inter_sum": 0.23857319881709166,
      "active_k": 10
    },
    {
      "iter": 29,
      "step_frac": 0.03,
      "overlap_L": 0.4235153236182452,
      "value_L": 0.005813929274168788,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6616205950951844,
      "overlap_pairs": 76,
      "inter_sum": 0.2380819481737854,
      "active_k": 10
    },
    {
      "iter": 30,
      "step_frac": 0.03,
      "overlap_L": 0.4235078168570496,
      "value_L": 0.005818989628617259,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6616181486884374,
      "overlap_pairs": 76,
      "inter_sum": 0.23774048324077066,
      "active_k": 10
    },
    {
      "iter": 31,
      "step_frac": 0.03,
      "overlap_L": 0.4235078168570496,
      "value_L": 0.005818989628617259,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6616181486884374,
      "overlap_pairs": 76,
      "inter_sum": 0.23774048324077066,
      "active_k": 10
    },
    {
      "iter": 32,
      "step_frac": 0.03,
      "overlap_L": 0.4235078168570496,
      "value_L": 0.005818989628617259,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6616181486884374,
      "overlap_pairs": 76,
      "inter_sum": 0.23774048324077066,
      "active_k": 10
    },
    {
      "iter": 33,
      "step_frac": 0.03,
      "overlap_L": 0.4235078168570496,
      "value_L": 0.005818989628617259,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6616181486884374,
      "overlap_pairs": 76,
      "inter_sum": 0.23774048324077066,
      "active_k": 10
    },
    {
      "iter": 34,
      "step_frac": 0.03,
      "overlap_L": 0.4235078168570496,
      "value_L": 0.005818989628617259,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6616181486884374,
      "overlap_pairs": 76,
      "inter_sum": 0.23774048324077066,
      "active_k": 10
    },
    {
      "iter": 35,
      "step_frac": 0.03,
      "overlap_L": 0.4235078168570496,
      "value_L": 0.005818989628617259,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6616181486884374,
      "overlap_pairs": 76,
      "inter_sum": 0.23774048324077066,
      "active_k": 10
    },
    {
      "iter": 36,
      "step_frac": 0.015,
      "overlap_L": 0.4235078168570496,
      "value_L": 0.005818989628617259,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6616181486884374,
      "overlap_pairs": 76,
      "inter_sum": 0.23774048324077066,
      "active_k": 10
    },
    {
      "iter": 37,
      "step_frac": 0.015,
      "overlap_L": 0.42248349415104663,
      "value_L": 0.005818989628617259,
      "same_L": 0.23229134220277048,
      "core_loss": 0.6605938259824344,
      "overlap_pairs": 76,
      "inter_sum": 0.23678330793424532,
      "active_k": 10
    },
    {
      "iter": 38,
      "step_frac": 0.015,
      "overlap_L": 0.42167021647951963,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6596619027248919,
      "overlap_pairs": 76,
      "inter_sum": 0.23592454127074097,
      "active_k": 10
    },
    {
      "iter": 39,
      "step_frac": 0.015,
      "overlap_L": 0.4207530165751417,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6587447028205139,
      "overlap_pairs": 76,
      "inter_sum": 0.23521048973259995,
      "active_k": 10
    },
    {
      "iter": 40,
      "step_frac": 0.015,
      "overlap_L": 0.4202579323461738,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6582496185915461,
      "overlap_pairs": 76,
      "inter_sum": 0.23450406781707694,
      "active_k": 10
    },
    {
      "iter": 41,
      "step_frac": 0.015,
      "overlap_L": 0.42010407822326395,
      "value_L": 0.00971546255393949,
      "same_L": 0.2282762236914326,
      "core_loss": 0.658095764468636,
      "overlap_pairs": 76,
      "inter_sum": 0.23426852303285614,
      "active_k": 10
    },
    {
      "iter": 42,
      "step_frac": 0.015,
      "overlap_L": 0.4200035627678145,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6579952490131867,
      "overlap_pairs": 76,
      "inter_sum": 0.23405143119623872,
      "active_k": 10
    },
    {
      "iter": 43,
      "step_frac": 0.015,
      "overlap_L": 0.4199275809055793,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6579192671509515,
      "overlap_pairs": 76,
      "inter_sum": 0.23387834747194633,
      "active_k": 10
    },
    {
      "iter": 44,
      "step_frac": 0.015,
      "overlap_L": 0.41992018197414727,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6579118682195195,
      "overlap_pairs": 76,
      "inter_sum": 0.23373244838631238,
      "active_k": 10
    },
    {
      "iter": 45,
      "step_frac": 0.015,
      "overlap_L": 0.41992018197414727,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6579118682195195,
      "overlap_pairs": 76,
      "inter_sum": 0.23373244838631238,
      "active_k": 10
    },
    {
      "iter": 46,
      "step_frac": 0.015,
      "overlap_L": 0.41992018197414727,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6579118682195195,
      "overlap_pairs": 76,
      "inter_sum": 0.23373244838631238,
      "active_k": 10
    },
    {
      "iter": 47,
      "step_frac": 0.015,
      "overlap_L": 0.41992018197414727,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6579118682195195,
      "overlap_pairs": 76,
      "inter_sum": 0.23373244838631238,
      "active_k": 10
    },
    {
      "iter": 48,
      "step_frac": 0.015,
      "overlap_L": 0.41992018197414727,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6579118682195195,
      "overlap_pairs": 76,
      "inter_sum": 0.23373244838631238,
      "active_k": 10
    },
    {
      "iter": 49,
      "step_frac": 0.015,
      "overlap_L": 0.41992018197414727,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6579118682195195,
      "overlap_pairs": 76,
      "inter_sum": 0.23373244838631238,
      "active_k": 10
    },
    {
      "iter": 50,
      "step_frac": 0.0075,
      "overlap_L": 0.41992018197414727,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6579118682195195,
      "overlap_pairs": 76,
      "inter_sum": 0.23373244838631238,
      "active_k": 10
    },
    {
      "iter": 51,
      "step_frac": 0.0075,
      "overlap_L": 0.4194467703684557,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6574384566138279,
      "overlap_pairs": 76,
      "inter_sum": 0.23346894199047166,
      "active_k": 10
    },
    {
      "iter": 52,
      "step_frac": 0.0075,
      "overlap_L": 0.4191895234399474,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6571812096853197,
      "overlap_pairs": 76,
      "inter_sum": 0.23322787096844996,
      "active_k": 10
    },
    {
      "iter": 53,
      "step_frac": 0.0075,
      "overlap_L": 0.4189458451784796,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6569375314238518,
      "overlap_pairs": 75,
      "inter_sum": 0.23288326712414217,
      "active_k": 10
    },
    {
      "iter": 54,
      "step_frac": 0.0075,
      "overlap_L": 0.41876119344764173,
      "value_L": 0.009715462553939638,
      "same_L": 0.2282762236914326,
      "core_loss": 0.656752879693014,
      "overlap_pairs": 75,
      "inter_sum": 0.23278062307395633,
      "active_k": 10
    },
    {
      "iter": 55,
      "step_frac": 0.0075,
      "overlap_L": 0.4186959862898248,
      "value_L": 0.00971546255393949,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6566876725351969,
      "overlap_pairs": 75,
      "inter_sum": 0.2326805446853985,
      "active_k": 10
    },
    {
      "iter": 56,
      "step_frac": 0.0075,
      "overlap_L": 0.4186449814106545,
      "value_L": 0.00971546255393949,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6566366676560266,
      "overlap_pairs": 75,
      "inter_sum": 0.2325746770909455,
      "active_k": 10
    },
    {
      "iter": 57,
      "step_frac": 0.0075,
      "overlap_L": 0.41864088341166555,
      "value_L": 0.009715462553939564,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6566325696570378,
      "overlap_pairs": 75,
      "inter_sum": 0.2325031547151396,
      "active_k": 10
    },
    {
      "iter": 58,
      "step_frac": 0.0075,
      "overlap_L": 0.41864088341166555,
      "value_L": 0.009715462553939564,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6566325696570378,
      "overlap_pairs": 75,
      "inter_sum": 0.2325031547151396,
      "active_k": 10
    },
    {
      "iter": 59,
      "step_frac": 0.0075,
      "overlap_L": 0.41864088341166555,
      "value_L": 0.009715462553939564,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6566325696570378,
      "overlap_pairs": 75,
      "inter_sum": 0.2325031547151396,
      "active_k": 10
    },
    {
      "iter": 60,
      "step_frac": 0.0075,
      "overlap_L": 0.41864088341166555,
      "value_L": 0.009715462553939564,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6566325696570378,
      "overlap_pairs": 75,
      "inter_sum": 0.2325031547151396,
      "active_k": 10
    },
    {
      "iter": 61,
      "step_frac": 0.0075,
      "overlap_L": 0.41864088341166555,
      "value_L": 0.009715462553939564,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6566325696570378,
      "overlap_pairs": 75,
      "inter_sum": 0.2325031547151396,
      "active_k": 10
    },
    {
      "iter": 62,
      "step_frac": 0.0075,
      "overlap_L": 0.41864088341166555,
      "value_L": 0.009715462553939564,
      "same_L": 0.2282762236914326,
      "core_loss": 0.6566325696570378,
      "overlap_pairs": 75,
      "inter_sum": 0.2325031547151396,
      "active_k": 10
    }
  ],
  "note": "Responsibility-based active-set optimizer. Backward compatible: accepts w_shrink but ignores it. Adds same-pair size penalty via relations.json."
}