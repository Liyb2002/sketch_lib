{
  "ok": true,
  "in_bbox_json": "/Users/yuanboli/Documents/GitHub/sketch_lib/controlNet_process/sketch/dsl_optimize/optimize_iteration/iter_000/heat_map/pca_bboxes/pca_bboxes.json",
  "out_bbox_json": "/Users/yuanboli/Documents/GitHub/sketch_lib/controlNet_process/sketch/dsl_optimize/optimize_iteration/iter_000/heat_map/pca_bboxes/pca_bboxes_optimized.json",
  "labels": 17,
  "heat_gamma": 2.0,
  "final": {
    "overlap_L": 0.32425985360606263,
    "value_L": 0.02604179229445675,
    "core_loss": 0.3503016459005194,
    "overlap_pairs": 69,
    "inter_sum": 0.17532738830294609
  },
  "history": [
    {
      "iter": 0,
      "step_frac": 0.06,
      "overlap_L": 0.45851390554175425,
      "value_L": 0.0,
      "core_loss": 0.45851390554175425,
      "overlap_pairs": 78,
      "inter_sum": 0.29032827710603787
    },
    {
      "iter": 1,
      "step_frac": 0.06,
      "overlap_L": 0.4477007942964906,
      "value_L": 0.0007453430361301454,
      "core_loss": 0.4484461373326208,
      "overlap_pairs": 78,
      "inter_sum": 0.28348147939706975
    },
    {
      "iter": 2,
      "step_frac": 0.06,
      "overlap_L": 0.43915663502561886,
      "value_L": 0.0009722742716851857,
      "core_loss": 0.440128909297304,
      "overlap_pairs": 78,
      "inter_sum": 0.2770141314949295
    },
    {
      "iter": 3,
      "step_frac": 0.06,
      "overlap_L": 0.43248904375265396,
      "value_L": 0.0010298347575832332,
      "core_loss": 0.4335188785102372,
      "overlap_pairs": 78,
      "inter_sum": 0.27225455506920876
    },
    {
      "iter": 4,
      "step_frac": 0.06,
      "overlap_L": 0.4252515119631578,
      "value_L": 0.0013176171842704042,
      "core_loss": 0.4265691291474282,
      "overlap_pairs": 78,
      "inter_sum": 0.2660763008965041
    },
    {
      "iter": 5,
      "step_frac": 0.06,
      "overlap_L": 0.4181611609559399,
      "value_L": 0.0013418231827296084,
      "core_loss": 0.41950298413866954,
      "overlap_pairs": 78,
      "inter_sum": 0.2607778108752366
    },
    {
      "iter": 6,
      "step_frac": 0.06,
      "overlap_L": 0.4121092892922343,
      "value_L": 0.002627790632024258,
      "core_loss": 0.41473707992425857,
      "overlap_pairs": 78,
      "inter_sum": 0.25664107493952104
    },
    {
      "iter": 7,
      "step_frac": 0.06,
      "overlap_L": 0.4071925176986815,
      "value_L": 0.002937761890151451,
      "core_loss": 0.4101302795888329,
      "overlap_pairs": 78,
      "inter_sum": 0.2517384831708878
    },
    {
      "iter": 8,
      "step_frac": 0.06,
      "overlap_L": 0.40070333416141596,
      "value_L": 0.003982654157935644,
      "core_loss": 0.4046859883193516,
      "overlap_pairs": 78,
      "inter_sum": 0.24427633383261582
    },
    {
      "iter": 9,
      "step_frac": 0.06,
      "overlap_L": 0.3959345691872009,
      "value_L": 0.004486988749588634,
      "core_loss": 0.4004215579367895,
      "overlap_pairs": 77,
      "inter_sum": 0.23957063865884642
    },
    {
      "iter": 10,
      "step_frac": 0.06,
      "overlap_L": 0.3924001123353488,
      "value_L": 0.004486988749588657,
      "core_loss": 0.39688710108493747,
      "overlap_pairs": 77,
      "inter_sum": 0.23652038462184624
    },
    {
      "iter": 11,
      "step_frac": 0.06,
      "overlap_L": 0.3867784955423741,
      "value_L": 0.004973125886513298,
      "core_loss": 0.39175162142888736,
      "overlap_pairs": 77,
      "inter_sum": 0.23313193766611576
    },
    {
      "iter": 12,
      "step_frac": 0.06,
      "overlap_L": 0.38479442383455786,
      "value_L": 0.00506994988035007,
      "core_loss": 0.38986437371490795,
      "overlap_pairs": 77,
      "inter_sum": 0.23023585454582216
    },
    {
      "iter": 13,
      "step_frac": 0.06,
      "overlap_L": 0.38261734203654313,
      "value_L": 0.005371852472564653,
      "core_loss": 0.3879891945091078,
      "overlap_pairs": 77,
      "inter_sum": 0.22740991547722203
    },
    {
      "iter": 14,
      "step_frac": 0.06,
      "overlap_L": 0.3768315804341656,
      "value_L": 0.005626687845633165,
      "core_loss": 0.38245826827979873,
      "overlap_pairs": 77,
      "inter_sum": 0.22311530425571005
    },
    {
      "iter": 15,
      "step_frac": 0.06,
      "overlap_L": 0.37504383713765005,
      "value_L": 0.005675123620815393,
      "core_loss": 0.38071896075846545,
      "overlap_pairs": 77,
      "inter_sum": 0.2201493591940112
    },
    {
      "iter": 16,
      "step_frac": 0.06,
      "overlap_L": 0.37149097270180276,
      "value_L": 0.007670101330287518,
      "core_loss": 0.37916107403209026,
      "overlap_pairs": 77,
      "inter_sum": 0.21673652791392634
    },
    {
      "iter": 17,
      "step_frac": 0.06,
      "overlap_L": 0.3667182698078462,
      "value_L": 0.008058069695603048,
      "core_loss": 0.37477633950344924,
      "overlap_pairs": 77,
      "inter_sum": 0.21395202134441887
    },
    {
      "iter": 18,
      "step_frac": 0.06,
      "overlap_L": 0.3618499722381875,
      "value_L": 0.008898555753534926,
      "core_loss": 0.3707485279917224,
      "overlap_pairs": 76,
      "inter_sum": 0.21031470618676398
    },
    {
      "iter": 19,
      "step_frac": 0.06,
      "overlap_L": 0.3579975538315788,
      "value_L": 0.00932182453302965,
      "core_loss": 0.36731937836460843,
      "overlap_pairs": 75,
      "inter_sum": 0.20702396836705647
    },
    {
      "iter": 20,
      "step_frac": 0.06,
      "overlap_L": 0.3566811108039544,
      "value_L": 0.00932182453302965,
      "core_loss": 0.3660029353369841,
      "overlap_pairs": 75,
      "inter_sum": 0.20511515001122868
    },
    {
      "iter": 21,
      "step_frac": 0.06,
      "overlap_L": 0.3520964330273273,
      "value_L": 0.011115421783178276,
      "core_loss": 0.36321185481050555,
      "overlap_pairs": 75,
      "inter_sum": 0.201749407412919
    },
    {
      "iter": 22,
      "step_frac": 0.06,
      "overlap_L": 0.34915278691967006,
      "value_L": 0.011928747334565195,
      "core_loss": 0.3610815342542352,
      "overlap_pairs": 73,
      "inter_sum": 0.19900584984478203
    },
    {
      "iter": 23,
      "step_frac": 0.06,
      "overlap_L": 0.3470358354791545,
      "value_L": 0.013226457809120068,
      "core_loss": 0.3602622932882746,
      "overlap_pairs": 73,
      "inter_sum": 0.19681746709551892
    },
    {
      "iter": 24,
      "step_frac": 0.06,
      "overlap_L": 0.34361037732996963,
      "value_L": 0.014403498262462719,
      "core_loss": 0.35801387559243236,
      "overlap_pairs": 72,
      "inter_sum": 0.19419233883846315
    },
    {
      "iter": 25,
      "step_frac": 0.06,
      "overlap_L": 0.3416714121833476,
      "value_L": 0.015749442077875805,
      "core_loss": 0.35742085426122344,
      "overlap_pairs": 72,
      "inter_sum": 0.1913465988311108
    },
    {
      "iter": 26,
      "step_frac": 0.06,
      "overlap_L": 0.33889550078582914,
      "value_L": 0.016981527401180637,
      "core_loss": 0.3558770281870098,
      "overlap_pairs": 72,
      "inter_sum": 0.18879684610511363
    },
    {
      "iter": 27,
      "step_frac": 0.06,
      "overlap_L": 0.3348804426855852,
      "value_L": 0.019839179997139085,
      "core_loss": 0.3547196226827243,
      "overlap_pairs": 72,
      "inter_sum": 0.18605380552802794
    },
    {
      "iter": 28,
      "step_frac": 0.06,
      "overlap_L": 0.3324145718353927,
      "value_L": 0.020759680328557108,
      "core_loss": 0.3531742521639498,
      "overlap_pairs": 72,
      "inter_sum": 0.18361568178391752
    },
    {
      "iter": 29,
      "step_frac": 0.06,
      "overlap_L": 0.32948941142381427,
      "value_L": 0.023492383779966774,
      "core_loss": 0.35298179520378103,
      "overlap_pairs": 70,
      "inter_sum": 0.1800353923075399
    },
    {
      "iter": 30,
      "step_frac": 0.06,
      "overlap_L": 0.32948941142381427,
      "value_L": 0.023492383779966774,
      "core_loss": 0.35298179520378103,
      "overlap_pairs": 70,
      "inter_sum": 0.1800353923075399
    },
    {
      "iter": 31,
      "step_frac": 0.06,
      "overlap_L": 0.32948941142381427,
      "value_L": 0.023492383779966774,
      "core_loss": 0.35298179520378103,
      "overlap_pairs": 70,
      "inter_sum": 0.1800353923075399
    },
    {
      "iter": 32,
      "step_frac": 0.06,
      "overlap_L": 0.32948941142381427,
      "value_L": 0.023492383779966774,
      "core_loss": 0.35298179520378103,
      "overlap_pairs": 70,
      "inter_sum": 0.1800353923075399
    },
    {
      "iter": 33,
      "step_frac": 0.06,
      "overlap_L": 0.32948941142381427,
      "value_L": 0.023492383779966774,
      "core_loss": 0.35298179520378103,
      "overlap_pairs": 70,
      "inter_sum": 0.1800353923075399
    },
    {
      "iter": 34,
      "step_frac": 0.06,
      "overlap_L": 0.32948941142381427,
      "value_L": 0.023492383779966774,
      "core_loss": 0.35298179520378103,
      "overlap_pairs": 70,
      "inter_sum": 0.1800353923075399
    },
    {
      "iter": 35,
      "step_frac": 0.03,
      "overlap_L": 0.32948941142381427,
      "value_L": 0.023492383779966774,
      "core_loss": 0.35298179520378103,
      "overlap_pairs": 70,
      "inter_sum": 0.1800353923075399
    },
    {
      "iter": 36,
      "step_frac": 0.03,
      "overlap_L": 0.3283445527063331,
      "value_L": 0.024611911208704974,
      "core_loss": 0.3529564639150381,
      "overlap_pairs": 70,
      "inter_sum": 0.17906493654714112
    },
    {
      "iter": 37,
      "step_frac": 0.03,
      "overlap_L": 0.32712723679956957,
      "value_L": 0.024956510493207306,
      "core_loss": 0.35208374729277686,
      "overlap_pairs": 70,
      "inter_sum": 0.1778967294283727
    },
    {
      "iter": 38,
      "step_frac": 0.03,
      "overlap_L": 0.32712723679956957,
      "value_L": 0.024956510493207306,
      "core_loss": 0.35208374729277686,
      "overlap_pairs": 70,
      "inter_sum": 0.1778967294283727
    },
    {
      "iter": 39,
      "step_frac": 0.03,
      "overlap_L": 0.32712723679956957,
      "value_L": 0.024956510493207306,
      "core_loss": 0.35208374729277686,
      "overlap_pairs": 70,
      "inter_sum": 0.1778967294283727
    },
    {
      "iter": 40,
      "step_frac": 0.03,
      "overlap_L": 0.32712723679956957,
      "value_L": 0.024956510493207306,
      "core_loss": 0.35208374729277686,
      "overlap_pairs": 70,
      "inter_sum": 0.1778967294283727
    },
    {
      "iter": 41,
      "step_frac": 0.03,
      "overlap_L": 0.32712723679956957,
      "value_L": 0.024956510493207306,
      "core_loss": 0.35208374729277686,
      "overlap_pairs": 70,
      "inter_sum": 0.1778967294283727
    },
    {
      "iter": 42,
      "step_frac": 0.03,
      "overlap_L": 0.32712723679956957,
      "value_L": 0.024956510493207306,
      "core_loss": 0.35208374729277686,
      "overlap_pairs": 70,
      "inter_sum": 0.1778967294283727
    },
    {
      "iter": 43,
      "step_frac": 0.015,
      "overlap_L": 0.32712723679956957,
      "value_L": 0.024956510493207306,
      "core_loss": 0.35208374729277686,
      "overlap_pairs": 70,
      "inter_sum": 0.1778967294283727
    },
    {
      "iter": 44,
      "step_frac": 0.015,
      "overlap_L": 0.32687550720863107,
      "value_L": 0.02498071649166651,
      "core_loss": 0.35185622370029757,
      "overlap_pairs": 70,
      "inter_sum": 0.17754641317617303
    },
    {
      "iter": 45,
      "step_frac": 0.015,
      "overlap_L": 0.3266404485661169,
      "value_L": 0.025106811825706152,
      "core_loss": 0.3517472603918231,
      "overlap_pairs": 70,
      "inter_sum": 0.17703106479474248
    },
    {
      "iter": 46,
      "step_frac": 0.015,
      "overlap_L": 0.3257947991578241,
      "value_L": 0.025448745332206254,
      "core_loss": 0.35124354449003037,
      "overlap_pairs": 70,
      "inter_sum": 0.17646314251573236
    },
    {
      "iter": 47,
      "step_frac": 0.015,
      "overlap_L": 0.324947538457383,
      "value_L": 0.0257755263114055,
      "core_loss": 0.3507230647687885,
      "overlap_pairs": 70,
      "inter_sum": 0.17589758912006098
    },
    {
      "iter": 48,
      "step_frac": 0.015,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 49,
      "step_frac": 0.015,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 50,
      "step_frac": 0.015,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 51,
      "step_frac": 0.015,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 52,
      "step_frac": 0.015,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 53,
      "step_frac": 0.015,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 54,
      "step_frac": 0.0075,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 55,
      "step_frac": 0.0075,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 56,
      "step_frac": 0.0075,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 57,
      "step_frac": 0.0075,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 58,
      "step_frac": 0.0075,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    },
    {
      "iter": 59,
      "step_frac": 0.0075,
      "overlap_L": 0.32425985360606263,
      "value_L": 0.02604179229445675,
      "core_loss": 0.3503016459005194,
      "overlap_pairs": 69,
      "inter_sum": 0.17532738830294609
    }
  ],
  "note": "Backward compatible: accepts w_shrink but ignores it. No shrink penalty. Value uses heat^gamma."
}